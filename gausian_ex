import cv2

def apply_gaussian_blur_to_video(video_path, output_path, blur_intensity):
    # 동영상 로드
    cap = cv2.VideoCapture(video_path)

    # 동영상의 속성 (프레임 너비, 높이, 초당 프레임 수)
    frame_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))
    frame_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))
    fps = cap.get(cv2.CAP_PROP_FPS)

    # 출력 동영상 설정 (코덱, FPS, 해상도)
    out = cv2.VideoWriter(output_path, cv2.VideoWriter_fourcc(*'mp4v'), fps, (frame_width, frame_height))

    # 사용자 입력값에 따라 커널 크기 설정 (홀수 값만 허용)
    kernel_size = 2 * (blur_intensity // 2) + 1
    sigma = blur_intensity / 2  # sigma 값을 사용자 입력에 따라 조정

    while True:
        ret, frame = cap.read()
        if not ret:
            break

        # 프레임에 가우시안 블러 적용
        blurred_frame = cv2.GaussianBlur(frame, (kernel_size, kernel_size), sigma)

        # 블러 처리된 프레임을 출력 동영상에 작성
        out.write(blurred_frame)

    # 모든 작업이 끝난 후 자원 해제
    cap.release()
    out.release()
    print(f"동영상 저장 완료: {output_path}")

# 동영상 경로와 저장할 경로
input_video_path = '/path/to/input_video.mp4'
output_video_path = '/path/to/output_blurred_video.mp4'

# 사용자 입력 (0~100 사이의 값)
user_input = 50  # 예: 50

# 동영상에 블러 적용
apply_gaussian_blur_to_video(input_video_path, output_video_path, user_input)
